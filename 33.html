<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>일일 활성 주소 수</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            color: white;
            overflow: hidden;
        }
        #chart {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>
    <div id="chart"></div>

    <script>
        // Base64 디코딩 함수
        function base64Decode(base64) {
            try {
                return decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
            } catch (e) {
                console.error('Base64 decoding failed:', e);
                return null;
            }
        }

        // 33.json 파일에서 Base64 데이터를 가져와 디코딩하는 함수
        async function fetchData() {
            const response = await fetch('33.json'); // JSON 파일 경로
            const base64Data = await response.text(); // Base64 문자열 가져오기
            const jsonData = base64Decode(base64Data); // Base64 디코딩
            if (!jsonData) {
                throw new Error('Failed to decode JSON data.');
            }
            const data = JSON.parse(jsonData); // JSON 파싱
            
            // 차트에 맞는 형식으로 데이터 변환
            return data.map(item => {
                return { x: item.Date, y: item.Total_Active_Addresses };
            });
        }

        // ApexCharts 옵션 설정
        async function createChart() {
            try {
                const seriesData = await fetchData();

                var options = {
                    chart: {
                        type: 'line',
                        width: '100%',
                        height: '100%',
                        background: '#000000',
                        toolbar: {
                            tools: {
                                download: false
                            }
                        }
                    },
                    series: [{
                        name: '일일 활성 주소 수',
                        data: seriesData
                    }],
                    xaxis: {
                        type: 'datetime',
                        labels: {
                            style: { colors: '#FFFFFF' }
                        }
                    },
                    yaxis: {
                        labels: {
                            style: { colors: '#FFFFFF' }
                        }
                    },
                    stroke: {
                        colors: ['#00FF00'],
                        width: 2
                    },
                    tooltip: {
                        x: {
                            format: 'yyyy-MM-dd'
                        },
                        theme: 'dark'
                    },
                    grid: {
                        borderColor: '#333333'
                    },
                    markers: {
                        size: 0
                    }
                };

                var chart = new ApexCharts(document.querySelector("#chart"), options);
                chart.render();
            } catch (error) {
                console.error('Error creating chart:', error);
            }
        }

        // 차트 생성 함수 호출
        createChart();
    </script>
</body>
</html>
